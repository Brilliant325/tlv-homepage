<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>The Lost Violets â€“ Logistik</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0b0614;--bg2:#140a24;
  --violet:#b388ff;--accent:#7c3aed;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:Arial,Helvetica,sans-serif;
  background:radial-gradient(circle at top,#1b0c30,var(--bg));
  color:#eee;
}
.hero{
  height:80vh;background:center/cover no-repeat;position:relative
}
.hero::after{
  content:"";position:absolute;inset:0;background:rgba(10,5,20,.75)
}
.hero-content{
  position:relative;z-index:2;height:100%;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;text-align:center
}
.hero img{width:220px}
.hero h1{margin:15px 0 0;color:var(--violet);font-size:3em}
.hero p{font-size:1.3em;opacity:0;animation:fadeIn 2s forwards}
@keyframes fadeIn{to{opacity:1}}

nav{
  background:var(--bg2);display:flex;
  justify-content:center;gap:30px;
  padding:15px;position:sticky;top:0;z-index:10
}
nav a{color:var(--violet);text-decoration:none;font-weight:bold}

section{max-width:1100px;margin:auto;padding:60px 20px}
h2{text-align:center;color:var(--violet);margin-bottom:30px}

.info-box{
  background:linear-gradient(135deg,#1a0d2e,#0f081c);
  border-radius:16px;padding:30px;
  box-shadow:0 0 40px rgba(124,58,237,.25)
}

.counters{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:20px
}
.counter{
  background:var(--bg2);padding:25px;border-radius:14px;text-align:center
}
.counter span{font-size:2.4em;color:var(--accent)}

.team{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px
}
.card{
  background:var(--bg2);padding:20px;border-radius:14px;text-align:center
}
.role{font-size:.9em;color:#c4b5fd}

.jobs-list{background:var(--bg2);border-radius:14px;overflow:hidden}
.jobs-list div{
  padding:12px 18px;border-bottom:1px solid #2a1b3d;font-size:.95em
}
.jobs-list div:last-child{border:none}

.buttons{text-align:center;margin-top:30px}
.buttons a{
  display:inline-block;padding:14px 28px;
  background:var(--accent);color:#fff;
  border-radius:12px;text-decoration:none;font-weight:bold
}

footer{
  background:var(--bg2);text-align:center;
  padding:30px;color:#aaa
}
</style>
</head>

<body>

<header class="hero" id="hero">
  <div class="hero-content">
    <img src="https://cdn.truckyapp.com/public/companies/39842/65F0gBO9Hlj7Yucicbw9.png">
    <h1 id="company-name">The Lost Violets â€“ Logistik</h1>
    <p id="company-slogan">Teuer, Langsam und Verloren</p>
  </div>
</header>

<nav>
  <a href="#info">Info</a>
  <a href="#stats">Statistik</a>
  <a href="#team">Team</a>
  <a href="#jobs">Fahrten</a>
  <a href="https://discord.gg/BKQZRThTAb" target="_blank">Discord</a>
</nav>

<section id="info">
<h2>ğŸ“Š Live-Speditionsdaten</h2>
<div class="info-box">
<p><b>Name:</b> <span id="company-name-2"></span></p>
<p><b>Slogan:</b> <span id="company-slogan-2"></span></p>
<p><b>Tag:</b> <span id="company-tag"></span></p>
<p><b>Status:</b> <span id="company-recruitment"></span></p>
<p><b>Sprache:</b> <span id="company-language"></span></p>
<p><b>Land:</b> <span id="company-country"></span></p>
</div>

<div class="buttons">
<a href="https://hub.truckyapp.com/vtc/the-lost-violets-logistik" target="_blank">
Jetzt Ã¼ber Trucky bewerben
</a>
</div>
</section>

<section id="stats">
<h2>ğŸšš Unsere Zahlen</h2>
<div class="counters">
<div class="counter"><span id="km">0</span><br>Kilometer</div>
<div class="counter"><span id="jobsCount">0</span><br>Fahrten</div>
<div class="counter"><span id="drivers">0</span><br>Fahrer</div>
</div>
</section>

<section id="team">
<h2>ğŸ§‘â€âœˆï¸ Unser Team</h2>
<div class="team" id="teamList">Lade Team â€¦</div>
</section>

<section id="jobs">
<h2>ğŸš› Letzte Fahrten</h2>
<div class="jobs-list" id="jobsList">Lade Fahrten â€¦</div>
</section>

<footer>
Â© 2025 The Lost Violets Logistik Â· Teuer Â· Langsam Â· Verloren ğŸ’œ
</footer>

<script>
const API="https://tlv-trucky-api.florian-ernst-339.workers.dev";

/* RANG PRIORITÃ„T */
const rankOrder=[
  "Inhaber / CEO",
  "Stellvertretender GeschÃ¤ftsfÃ¼hrung",
  "Disposition / Fuhrparkleiter / HR",
  "Senior Fahrer",
  "Fahrer",
  "Trainee / Junior Fahrer",
  "Fahrer auf Probe"
];

function rankIndex(role){
  const i=rankOrder.findIndex(r=>role.includes(r));
  return i===-1?999:i;
}

function animate(el,target){
  let n=0,step=target/60;
  const i=setInterval(()=>{
    n+=step;
    if(n>=target){el.innerText=target.toLocaleString("de-DE");clearInterval(i)}
    else el.innerText=Math.floor(n).toLocaleString("de-DE")
  },20)
}

document.addEventListener("DOMContentLoaded",()=>{

fetch(API+"/company").then(r=>r.json()).then(d=>{
  company-name.innerText=d.name;
  company-name-2.innerText=d.name;
  company-slogan.innerText=d.slogan;
  company-slogan-2.innerText=d.slogan;
  company-tag.innerText=d.tag;
  company-language.innerText=d.language;
  company-country.innerText=d.country_code;
  company-recruitment.innerText=
    d.recruitment==="open"?"ğŸŸ¢ Bewerbungen offen":"ğŸ”´ Geschlossen";
  if(d.cover)
    hero.style.backgroundImage="url(https://cdn.truckyapp.com/"+d.cover+")";
  animate(km,d.distance);
  animate(jobsCount,d.jobs);
  animate(drivers,d.drivers);
});

/* TEAM SORTIERT */
fetch(API+"/members").then(r=>r.json()).then(list=>{
  const t=teamList;t.innerHTML="";
  list
    .map(m=>({
      name:m.name||m.user?.name||"Unbekannt",
      role:m.role||m.role?.name||"Fahrer"
    }))
    .sort((a,b)=>rankIndex(a.role)-rankIndex(b.role))
    .forEach(m=>{
      t.innerHTML+=`
        <div class="card">
          <b>${m.name}</b><br>
          <span class="role">${m.role}</span>
        </div>`;
    });
});

/* FAHRTEN */
fetch(API+"/jobs").then(r=>r.json()).then(list=>{
  jobsList.innerHTML="";
  list.forEach(j=>{
    const from=j.from&&j.from!=="â€“"?j.from:"Unbekannt";
    const to=j.to&&j.to!=="â€“"?j.to:"Unbekannt";
    const dist=j.distance&&j.distance>0?j.distance:"â€“";
    jobsList.innerHTML+=`
      <div>${j.driver} â€” ${from} âœ ${to} (${dist} km)</div>`;
  });
});
});
</script>

</body>
</html>
